<!doctype html><html lang=zh dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="1. 查看设备 # PMON> devls syn0 wd0 usb0 sync0, igb0, em0 等字样,表示网络设备, 即网卡
wd0, nvme0, usb0, cd0等字样表示存储设备, 即硬盘, U盘等.
2. 查看pci信息 # PMON> pciscan >> BUS 0 << Dev Fun Device description -------------------------- 0 0 vendor/product: 0x0014/0x7a00 (bridge, host, interface: 0x00, revision: 0x00) 0x00000000:0x00000000 mem @0x00000000, 0 bytes 0 1 vendor/product: 0x0014/0x7a10 (bridge, host, interface: 0x00, revision: 0x01) 0x00000000:0x00000000 mem @0x00000000, 0 bytes 0 2 vendor/product: 0x0014/0x7a20 (bridge, host, interface: 0x00, revision: 0x01) 0x00000000:0x00000000 mem @0x00000000, 0 bytes 0 3 vendor/product: 0x0014/0x7a30 (bridge, host, interface: 0x00, revision: 0x00) 0x00000000:0x00000000 mem @0x00000000, 0 bytes 4 0 vendor/product: 0x0014/0x7a24 (serialbus, USB, interface: 0x10, revision: 0x02) 64-bit mem,low address 0x59648004:0xffff8004 mem @0x59648000, 32768 bytes 0x00000000:0x00000000 mem @0x00000000, 0 bytes ."><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:title" content="PMON的使用方法"><meta property="og:description" content="1. 查看设备 # PMON> devls syn0 wd0 usb0 sync0, igb0, em0 等字样,表示网络设备, 即网卡
wd0, nvme0, usb0, cd0等字样表示存储设备, 即硬盘, U盘等.
2. 查看pci信息 # PMON> pciscan >> BUS 0 << Dev Fun Device description -------------------------- 0 0 vendor/product: 0x0014/0x7a00 (bridge, host, interface: 0x00, revision: 0x00) 0x00000000:0x00000000 mem @0x00000000, 0 bytes 0 1 vendor/product: 0x0014/0x7a10 (bridge, host, interface: 0x00, revision: 0x01) 0x00000000:0x00000000 mem @0x00000000, 0 bytes 0 2 vendor/product: 0x0014/0x7a20 (bridge, host, interface: 0x00, revision: 0x01) 0x00000000:0x00000000 mem @0x00000000, 0 bytes 0 3 vendor/product: 0x0014/0x7a30 (bridge, host, interface: 0x00, revision: 0x00) 0x00000000:0x00000000 mem @0x00000000, 0 bytes 4 0 vendor/product: 0x0014/0x7a24 (serialbus, USB, interface: 0x10, revision: 0x02) 64-bit mem,low address 0x59648004:0xffff8004 mem @0x59648000, 32768 bytes 0x00000000:0x00000000 mem @0x00000000, 0 bytes ."><meta property="og:type" content="article"><meta property="og:url" content="https://loonguser.github.io/firmware/pmon/"><meta property="article:section" content="firmware"><meta property="article:modified_time" content="2023-11-27T15:27:44+08:00"><title>PMON的使用方法 | 龙芯玩机指南</title>
<link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png><link rel=stylesheet href=/book.min.f8de3645fe00591b41524aee174e19edd98a22255a2930a0cdc82a94835ba387.css integrity="sha256-+N42Rf4AWRtBUkruF04Z7dmKIiVaKTCgzcgqlINbo4c=" crossorigin=anonymous><script defer src=/flexsearch.min.js></script><script defer src=/zh.search.min.3e24046a2d7f004ebe360cd4cc5b8c89656d2dcd9a9fa0ca1de53558f9c6f009.js integrity="sha256-PiQEai1/AE6+NgzUzFuMiWVtLc2an6DKHeU1WPnG8Ak=" crossorigin=anonymous></script><script defer src=/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js integrity="sha256-b2+Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC+NdcPIvZhzk=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>龙芯玩机指南</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=搜索 aria-label=搜索 maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul class=book-languages><li><input type=checkbox id=languages class=toggle>
<label for=languages class="flex justify-between"><a role=button class="flex align-center"><img src=/svg/translate.svg class=book-icon alt=Languages>
Chinese</a></label><ul><li><a href=https://loonguser.github.io/en/>English</a></li><li><a href=https://loonguser.github.io/ru/>Russian</a></li></ul></li></ul><h2 id=headless-true>content/content.zh/menu/index.md&mdash;
headless: true
<a class=anchor href=#headless-true>#</a></h2><ul><li><p><a href=/firmware/><strong>固件</strong></a></p><ul><li><a href=/firmware/firmware/>如何更新固件</a></li><li><a href=/firmware/grub/>Grub编译与调试</a></li><li><a href=/firmware/pmon/ class=active>PMON的使用方法</a></li><li><a href=/firmware/uefi/>从UEFI如何启动到系统</a></li></ul></li><li><p><a href=/system/><strong>系统</strong></a></p><ul><li><a href=/system/kernel/>内核编译</a></li><li><a href=/system/gen_sys_file/>生成系统下的一些文件</a></li><li><a href=/system/systeminfo/>系统下查看一些信息</a></li><li><a href=/system/update_system/>如何更新系统</a></li></ul></li><li><p><a href=/applications/><strong>应用</strong></a></p><ul><li><a href=/applications/blog/>3A6000上搭建hexo博客</a></li><li><a href=/applications/gogs/>3A6000上搭建gogs</a></li><li><a href=/applications/qemu/>Qemu使用</a></li><li><a href=/applications/ejtag/>龙芯lajtag常用技巧</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu>
</label><strong>PMON的使用方法</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li><a href=#1-查看设备>1. 查看设备</a></li><li><a href=#2-查看pci信息>2. 查看pci信息</a></li><li><a href=#3-产看固件版本信息>3. 产看固件版本信息</a></li><li><a href=#4-查看寄存器信息>4. 查看寄存器信息</a></li><li><a href=#5-查看磁盘信息>5. 查看磁盘信息</a></li><li><a href=#6-查看磁盘中的文件>6. 查看磁盘中的文件</a></li><li><a href=#7-加载内核>7. 加载内核</a></li><li><a href=#8-加载initrd>8. 加载initrd</a></li><li><a href=#9-启动内核>9. 启动内核</a></li><li><a href=#10-加载引导文件>10. 加载引导文件</a></li><li><a href=#11-查看文件>11. 查看文件</a></li><li><a href=#12-配置网络>12. 配置网络</a></li><li><a href=#13-加载网络文件>13. 加载网络文件</a></li><li><a href=#14-更新固件>14. 更新固件</a></li></ul></li></ul></nav></aside></header><article class=markdown><h2 id=1-查看设备>1. 查看设备
<a class=anchor href=#1-%e6%9f%a5%e7%9c%8b%e8%ae%be%e5%a4%87>#</a></h2><pre tabindex=0><code>PMON&gt; devls
syn0
wd0
usb0
</code></pre><p><code>sync0</code>, <code>igb0</code>, <code>em0</code> 等字样,表示网络设备, 即网卡</p><p><code>wd0</code>, <code>nvme0</code>, <code>usb0</code>, <code>cd0</code>等字样表示存储设备, 即硬盘, <code>U</code>盘等.</p><h2 id=2-查看pci信息>2. 查看pci信息
<a class=anchor href=#2-%e6%9f%a5%e7%9c%8bpci%e4%bf%a1%e6%81%af>#</a></h2><pre tabindex=0><code>PMON&gt; pciscan
&gt;&gt; BUS  0 &lt;&lt;
Dev Fun Device description
--------------------------
  0   0 vendor/product: 0x0014/0x7a00 (bridge, host, interface: 0x00, revision: 0x00)
0x00000000:0x00000000 mem @0x00000000, 0 bytes
  0   1 vendor/product: 0x0014/0x7a10 (bridge, host, interface: 0x00, revision: 0x01)
0x00000000:0x00000000 mem @0x00000000, 0 bytes
  0   2 vendor/product: 0x0014/0x7a20 (bridge, host, interface: 0x00, revision: 0x01)
0x00000000:0x00000000 mem @0x00000000, 0 bytes
  0   3 vendor/product: 0x0014/0x7a30 (bridge, host, interface: 0x00, revision: 0x00)
0x00000000:0x00000000 mem @0x00000000, 0 bytes
  4   0 vendor/product: 0x0014/0x7a24 (serialbus, USB, interface: 0x10, revision: 0x02)
64-bit mem,low address
0x59648004:0xffff8004 mem @0x59648000, 32768 bytes
0x00000000:0x00000000 mem @0x00000000, 0 bytes
  ......
  ......
</code></pre><h2 id=3-产看固件版本信息>3. 产看固件版本信息
<a class=anchor href=#3-%e4%ba%a7%e7%9c%8b%e5%9b%ba%e4%bb%b6%e7%89%88%e6%9c%ac%e4%bf%a1%e6%81%af>#</a></h2><pre tabindex=0><code>PMON&gt; vers
PMON: PMON 5.0.3-Release (loongson) #233: Wed Oct 18 15:09:40 CST 2023 commit d044be8f495e97082c8905b131d525ef31ade0b9 Author: Xiangdong Meng &lt;mengxiangdong@loongson.cn&gt; Date:   Wed Sep 6 15:15:31 2023 +0800
</code></pre><h2 id=4-查看寄存器信息>4. 查看寄存器信息
<a class=anchor href=#4-%e6%9f%a5%e7%9c%8b%e5%af%84%e5%ad%98%e5%99%a8%e4%bf%a1%e6%81%af>#</a></h2><pre tabindex=0><code>PMON&gt; d8 0x800000001fe00020 2
800000001fe00020 : 0000303030364133 0000000000000000 3A6000..........
</code></pre><h2 id=5-查看磁盘信息>5. 查看磁盘信息
<a class=anchor href=#5-%e6%9f%a5%e7%9c%8b%e7%a3%81%e7%9b%98%e4%bf%a1%e6%81%af>#</a></h2><p>这里<code>fdisk</code>命令后面的设备名是在第一节中<code>devls</code>命令列出来的.</p><p><code>PMON</code>支持<code>GPT</code>和<code>MBR</code>分区</p><p><code>PMON</code>暂不支持设备热插拔.</p><p><code>MBR</code>:</p><pre tabindex=0><code>PMON&gt; fdisk usb0

Device    Boot  Start       End         Sectors     Id        System
usb0a           2048        122880000   122877952   83        Linux
</code></pre><p><code>GPT</code>:</p><pre tabindex=0><code>PMON&gt; fdisk usb0

Device    Boot  Start       End         Sectors     Id        System
usb0a           2048        122877951   122875904   0FC63DAF  Linux filesystem
</code></pre><h2 id=6-查看磁盘中的文件>6. 查看磁盘中的文件
<a class=anchor href=#6-%e6%9f%a5%e7%9c%8b%e7%a3%81%e7%9b%98%e4%b8%ad%e7%9a%84%e6%96%87%e4%bb%b6>#</a></h2><p><code>/dev/fs/</code>后的字符是<code>fdisk usb0</code>命令中, <code>Device</code>一列中显示的内容.</p><p><code>PMON</code>只支持<code>Fat</code>, <code>Ext2/3/4</code>, <code>ISO9660</code>等分区</p><p><code>PMON</code>在查看文件时, 通常不用指定文件系统类型.</p><p>比如加载一个<code>fat</code>分区的内容: <code>load /dev/fs/usb0/</code>和<code>load /dev/fs/fat@usb0/</code>的效果是一样的</p><p><code>Fat</code>分区:</p><pre tabindex=0><code>PMON&gt; load /dev/fs/usb0/
gz.mxd                                  &lt;FILE&gt;         993222
boot.cfg                                &lt;FILE&gt;         403
vm.mxd                                  &lt;FILE&gt;         95024056

/dev/fs/fat@usb0/: Is a directory
</code></pre><p><code>ext2</code>/<code>ext3</code>/<code>ext4</code>分区:</p><pre tabindex=0><code>PMON&gt; load /dev/fs/usb1a/
|./ ../ lost+found/ gz.mxd boot.cfg
/dev/fs/ext4@usb1a/: Undefined error: 0
</code></pre><p><img src=/images/pmon/1.png alt="load MBR"></p><h2 id=7-加载内核>7. 加载内核
<a class=anchor href=#7-%e5%8a%a0%e8%bd%bd%e5%86%85%e6%a0%b8>#</a></h2><pre tabindex=0><code>PMON&gt; load /dev/fs/usb0a/vm.mxd
\Loading file: /dev/fs/fat@usb0a/vm.mxd (elf)
(elf)
0x9000000000200000/20053784 + 0x151ff18/922672(z) + 31926 syms|
Entry address is 00c01000
</code></pre><h2 id=8-加载initrd>8. 加载initrd
<a class=anchor href=#8-%e5%8a%a0%e8%bd%bdinitrd>#</a></h2><pre tabindex=0><code>PMON&gt; initrd /dev/fs/usb0a/initrd.img-4.19.0-19-loongson-3
Loading initrd image /dev/fs/usb0a/initrd.img-4.19.0-19-loongson--dl_offset 9000000090000000 addr 9000000090000000
(bin)
</code></pre><h2 id=9-启动内核>9. 启动内核
<a class=anchor href=#9-%e5%90%af%e5%8a%a8%e5%86%85%e6%a0%b8>#</a></h2><p>必须要在加载内核之后执行:</p><pre tabindex=0><code>PMON&gt; g console=ttyS0,115200 earlycon=uart,mmio,0x1fe001e0 root=/dev/sda3
Warning! NVRAM checksum fail. Reset!
Reached finished_ap_limit=7 in a5 microseconds
BootCore ID: 0 Collect AP: 7 Total Core: 8
ACPI: ACPI tables init.
VBIOS crc check is wrong,use default setting!
GMEM: Get vbios from ls3a spi done!
Init acpi table OK!
set coherent
[    0.000000] Linux version 4.19.190+ (mengxiangdong@5.5) (gcc version 8.3.0 (GCC)) #9 SMP Tue Oct 17 11:14:31 CST 2023
[    0.000000] 64-bit Loongson Processor probed (LA664 Core)
[    0.000000] CPU0 revision is: 0014d000 (Loongson-64bit)
[    0.000000] FPU0 revision is: 00000001
[    0.000000] efi:  SMBIOS=0xfffe000  ACPI 2.0=0xfefe000  NEWMEM=0xb036800
[    0.000000] earlycon: uart0 at MMIO 0x000000001fe001e0 (options &#39;&#39;)
[    0.000000] bootconsole [uart0] enabled
[    0.000000] ACPI: Early table checksum verification disabled
[    0.000000] ACPI: RSDP 0x000000000FEFE000 000024 (v02 LOONGS)
......
......
</code></pre><h2 id=10-加载引导文件>10. 加载引导文件
<a class=anchor href=#10-%e5%8a%a0%e8%bd%bd%e5%bc%95%e5%af%bc%e6%96%87%e4%bb%b6>#</a></h2><p><code>UEFI</code>通过找到<code>grub.efi</code>, 接着找到<code>grub.cfg</code>, 进而引导内核</p><p>而<code>PMON</code>只需要找到<code>boot.cfg</code>文件即可. <code>PMON</code>默认会从<code>/</code>和<code>/boot</code>目录中找<code>boot.cfg</code></p><p>倘若没有找到, 可以手动加载:</p><pre tabindex=0><code>PMON&gt; bl /dev/fs/fat@usb0a/boot.cfg

������������������������������������������������Ŀ
�                 Boot Menu List                 �
������������������������������������������������Ĵ
� -&gt; 1 Loongnix 20 GNU/Linux 4.19.0-19-loongson-3�
�                                                �
�                                                �
�                                                �
�                                                �
�                                                �
�                                                �
�                                                �
�                                                �
� Please Select Boot Menu [1]                    �
��������������������������������������������������
Use the UP and DOWN keys to select the entry.
Press ENTER to boot selected OS.
Press &#39;c&#39; to command-line.
                                                 Booting system in [2] second(s)
</code></pre><h2 id=11-查看文件>11. 查看文件
<a class=anchor href=#11-%e6%9f%a5%e7%9c%8b%e6%96%87%e4%bb%b6>#</a></h2><pre tabindex=0><code>PMON&gt; devcp /dev/fs/fat@usb0a/boot.cfg /dev/tty0

default 0
timeout 3
showmenu 0

title Loongnix 20 GNU/Linux 4.19.0-19-loongson-3
    kernel /dev/fs/fat@usb0a/vmlinuz-4.19.0-19-loongson-3
    initrd /dev/fs/fat@usb0a/initrd.img-4.19.0-19-loongson-3
    args   root=/dev/sda3 console=ttyS0,115200 loglevel=8
</code></pre><h2 id=12-配置网络>12. 配置网络
<a class=anchor href=#12-%e9%85%8d%e7%bd%ae%e7%bd%91%e7%bb%9c>#</a></h2><pre tabindex=0><code>PMON&gt; devls
Device name  Type
syn0         IFNET
usb0         DISK
PMON&gt; ifconfig syn0 192.168.1.13
synopGMAC_linux_open called
Version = 0xd137
MacAddr = 0x3e  0xd0    0x62    0xf5    0x46    0x94

===phy HALFDUPLEX MODE
DMA status reg = 0x0 before cleared!
DMA status reg = 0x0 after cleared!
register poll interrupt: gmac 0
==arp_ifinit done
===phy FULLDUPLEX MODE
Link is with 1000M Speed

PMON&gt; 
</code></pre><h2 id=13-加载网络文件>13. 加载网络文件
<a class=anchor href=#13-%e5%8a%a0%e8%bd%bd%e7%bd%91%e7%bb%9c%e6%96%87%e4%bb%b6>#</a></h2><p><code>PMON</code>支持从网络加载内核, 支持的协议有<code>http</code>和<code>tftp</code></p><p><code>http</code>:</p><pre tabindex=0><code>PMON&gt; load http://192.168.1.4/vm.mxd
\Loading file: http://192.168.1.4/vm.mxd (elf)
(elf)
0x9000000000200000/20053784 + 0x151ff18/922672(z) + 31926 syms|
Entry address is 00c01000
</code></pre><p><code>tftp</code>:</p><pre tabindex=0><code>PMON&gt; load tftp://192.168.1.4/vm.mxd
\Loading file: tftp://192.168.1.4/vm.mxd (elf)
(elf)
0x9000000000200000/20053784 + 0x151ff18/922672(z) + 31926 syms|
Entry address is 00c01000
</code></pre><h2 id=14-更新固件>14. 更新固件
<a class=anchor href=#14-%e6%9b%b4%e6%96%b0%e5%9b%ba%e4%bb%b6>#</a></h2><p><code>PMON</code>更新固件的命令为<code>fload</code></p><p>与加载内核类似, 可以从硬盘加载, 也可以从网络加载</p><p>从硬盘加载:</p><pre tabindex=0><code>PMON&gt; fload /dev/fs/usb0a/gz.mxd
Loading file: /dev/fs/fat@usb0a/gz.mxd dl_offset 900000000f800000 addr 900000000f800000
(bin)
-
Loaded 993222 bytes

Programming flash 900000000f800000:f27c6 into 800000001c000000
Erase end!
-Programming end!
</code></pre><p>从<code>tftp</code>服务器加载:</p><pre tabindex=0><code>PMON&gt; fload tftp://192.168.1.4/gz.mxd
Loading file: tftp://192.168.1.4/gz.mxd dl_offset 900000000f800000 addr 900000000f800000
(bin)
-
Loaded 993222 bytes

Programming flash 900000000f800000:f27c6 into 800000001c000000
Erase end!
-Programming end!
</code></pre><p>从<code>http</code>服务器加载:</p><pre tabindex=0><code>PMON&gt; fload http://192.168.1.4/gz.mxd
Loading file: http://192.168.1.4/gz.mxd dl_offset 900000000f800000 addr 900000000f800000
(bin)
-
Loaded 993222 bytes

Programming flash 900000000f800000:f27c6 into 800000001c000000
Erase end!
-Programming end!
</code></pre></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/LoongUser/loonguser.github.io/commit/834cd38246fea6d7c72da4a8485ee7c7b57450d5 title='最后修改者 AydenMeng | November 27, 2023' target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt=Calendar>
<span>November 27, 2023</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li><a href=#1-查看设备>1. 查看设备</a></li><li><a href=#2-查看pci信息>2. 查看pci信息</a></li><li><a href=#3-产看固件版本信息>3. 产看固件版本信息</a></li><li><a href=#4-查看寄存器信息>4. 查看寄存器信息</a></li><li><a href=#5-查看磁盘信息>5. 查看磁盘信息</a></li><li><a href=#6-查看磁盘中的文件>6. 查看磁盘中的文件</a></li><li><a href=#7-加载内核>7. 加载内核</a></li><li><a href=#8-加载initrd>8. 加载initrd</a></li><li><a href=#9-启动内核>9. 启动内核</a></li><li><a href=#10-加载引导文件>10. 加载引导文件</a></li><li><a href=#11-查看文件>11. 查看文件</a></li><li><a href=#12-配置网络>12. 配置网络</a></li><li><a href=#13-加载网络文件>13. 加载网络文件</a></li><li><a href=#14-更新固件>14. 更新固件</a></li></ul></li></ul></nav></div></aside></main></body></html>